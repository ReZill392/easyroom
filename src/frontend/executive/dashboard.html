<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="dashboard.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap JS (‡∏û‡∏£‡πâ‡∏≠‡∏° Popper.js) -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
  <title>Dashboard</title>
</head>

<body>
  <div id="sidebar-container"></div>
  <div class="main-content overflow-auto vh-100">
    <div class="container">
      <div class="card blue" onclick="window.location.href='detailroom.html'" >
        <div>
          <h3  style="font-weight: normal; opacity: 0.9;" >Most Booking Room</h3>
          <p id="room-name" style="font-weight:bolder; font-size: 20px;">Loading...</p>
          <!-- <canvas id='pointLineCardChart1' style='width: 80px; height: 100px;'></canvas> -->
        </div>
      </div>

      <div class="card sky">
        <div  onclick="window.location.href='broken_equipment.html'">
          <h3 style="font-weight: normal; opacity: 0.9;" >Most Brokend Equipment</h3>
          <p id="equipment-name" style="font-weight: bold; font-size: large;">Loading...</p>
          <!-- <canvas id='pointLineCardChart2' ></canvas> -->
        </div>
      </div>
      <div class="card yellow" onclick="window.location.href='graphdetail.html'">
        <div >
          <h3 style="font-weight: normal; opacity: 0.9;">Most Time Used</h3>
          <p id="time"  style="font-weight:bolder; font-size: 16px;">Loading...</p>
          <!-- <canvas id='pointLineCardChart3' ></canvas> -->
        </div>
      </div>
      <div class="card red">
        <div onclick="window.location.href='student.html'">
          <h3 style="font-weight: normal; opacity: 0.9;">Most Department</h3>
          <p id="department-name" >Loading...</p>
          <!-- <canvas id='pointLineCardChart4' ></canvas> -->
        </div>
      </div>
    </div>

    <div class="large-card" style="justify-content: center; align-items: center; ">
      <h3>‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏¢‡∏≠‡∏∞‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h3>
      <div class="chart-container" style="display: flex; justify-content: center; align-items: center;">
        <canvas id="barChart" style="height: 300px ; align-items: center;"></canvas>
      </div>
      <button class="details-btn" onclick="window.location.href='detailroom.html'">Details</button>
    </div>

    <div class="statistics-container">
      <div class="statistics-card">
        <h5>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡∏à‡∏≠‡∏á
          <div class="dropdown d-inline">
            <i class="bi bi-caret-down-fill" type="button" data-bs-toggle="dropdown" aria-expanded="false"
              style="color: #929292; font-size: 10px;">
            </i>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#" onclick="showChart('day')">‡∏ß‡∏±‡∏ô</a></li>
              <li><a class="dropdown-item" href="#" onclick="showChart('week')">‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</a></li>
              <li><a class="dropdown-item" href="#" onclick="showChart('month')">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</a></li>
              <li><a class="dropdown-item" href="#" onclick="showChart('year')">‡∏õ‡∏µ</a></li>
            </ul>
          </div>
        </h5>
        <div style=" width: 100%; height: 80%;display: flex;align-items: center;justify-content: center;">
          <canvas id='pointLineChart' style=" width: 100% !important; height: 100% !important;"></canvas>
          
        </div>
        <!-- <canvas id="bookingChart"></canvas> -->
        <button class="details-btn" onclick="window.location.href='graphdetail.html'">Details</button>
      </div>

      <div class="statistics-card">
        <h5 style="text-align: center;">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
          <div class="dropdown d-inline">
            <i class="bi bi-caret-down-fill" type="button" data-bs-toggle="dropdown" aria-expanded="false"
              style="color: #929292; font-size: 10px;">
            </i>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#" onclick="showDoughnutChart(2)">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°</a></li>
              <li><a class="dropdown-item" href="#" onclick="showDoughnutChart(1)">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏¢‡∏∑‡∏°</a></li>
            </ul>
          </div>
        </h5>
        <!-- <img src="Insert graph.jpg" alt="‡πÉ‡∏™‡πà‡∏£‡∏π‡∏õ‡∏Å‡∏£‡∏≤‡∏ü" width="250" height="250"><br> -->
        <div class="chart-container" style=" width: 100%;height: 80%;display: flex; align-items: center;justify-content: center;">
          <canvas id="doughnutChart2" style="width: 80%;" onclick="window.location.href='broken_equipment.html'"></canvas>
          <canvas id="doughnutChart1" style="display: none; width: 80%;" onclick="window.location.href='borrow_equipment.html'"></canvas>
        </div>
        <button class="details-btn" onclick="window.location.href='eqiup.html'">Details</button>
      </div>

      <div class="statistics-card">
        <h6 style="text-align: center;">‡∏ô‡∏¥‡∏™‡∏¥‡∏ï‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h6>
        <section style="margin-top: 40px;">
          <section id="userList">
          </section>
          <button class="details-btn" onclick="window.location.href='student.html'">Details</button>
      </div>
      <div class="statistics-card">
        <h6 style="text-align: center;">‡∏ô‡∏¥‡∏™‡∏¥‡∏ï‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h6>
        <section style="margin-top: 40px;">
          <section id="ReportList">
          </section>
          <button class="details-btn" onclick="window.location.href='reporttable.html'">Details</button>
      </div>
    </div>

  </div>




</body>

<script>
  fetch("sidebar.html")
    .then((resp) => resp.text())
    .then((html) => {
      // ‡πÅ‡∏ó‡∏£‡∏Å Sidebar ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤
      document.getElementById("sidebar-container").innerHTML = html;
    })
    .then(() => {
      // ‡πÉ‡∏´‡πâ Highlight ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
      const btnStats = document.getElementById("btnStatistic");
      btnStats.classList.add("btn-sidebar-active");
    })
    .catch((err) => console.error("Failed to load sidebar:", err));

  fetch('http://localhost:3000/mostroomalldata')
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      console.log("Fetched Data:", data); // üõ† Debug: ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• API

      const barCtx = document.getElementById('barChart').getContext('2d');
      if (!barCtx) {
        console.error("Canvas element not found!");
        return;
      }

      // Prepare data for the Chart.js chart after fetching
      const labels = data.map(item => `SC2-${item.room_id}`);
      const totalCount = data.map(item => item.total_count);
      const csCount = data.map(item => item.cs_count);
      const itCount = data.map(item => item.it_count);

      new Chart(barCtx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [
            {
              label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏¥‡∏™‡∏¥‡∏ï‡∏£‡∏ß‡∏°',
              data: totalCount,
              backgroundColor: '#E5D2BA'
            },
            {
              label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏¥‡∏™‡∏¥‡∏ï ‡∏™‡∏≤‡∏Ç‡∏≤ ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏Ø',
              data: csCount,
              backgroundColor: '#E54715'
            },
            {
              label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏¥‡∏™‡∏¥‡∏ï ‡∏™‡∏≤‡∏Ç‡∏≤‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏Ø',
              data: itCount,
              backgroundColor: '#622BBE',
              padding: {
                top: 10,
                bottom: 30
              }
            }
          ]
        },
        options: {
          // maxBarThickness:30,
          responsive: false,
          plugins: {
            legend: {
              position: 'bottom', // Position legend at the bottom
              labels: {
                font: {
                  size: 16 // üî• ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏Ç‡∏≠‡∏á legend
                }
              }
            },
            title: {
              display: true,
              text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏¥‡∏™‡∏¥‡∏ï',
              font: {
                size: 14 // üî• ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏Ç‡∏≠‡∏á title
              }
            }
          },
          scales: {
            x: {
              ticks: {
                font: {
                  size: 16 // üî• ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏Ç‡∏≠‡∏á labels ‡∏ö‡∏ô‡πÅ‡∏Å‡∏ô X
                }
              }
            },
            y: {
              beginAtZero: true,
              ticks: {
                callback: function (value) {
                  return Math.floor(value); // üî• ‡∏õ‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏°‡∏≠‡∏≠‡∏Å
                },
                font: {
                  size: 14 // üî• ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏Ç‡∏≠‡∏á labels ‡∏ö‡∏ô‡πÅ‡∏Å‡∏ô Y
                }
              }
            }
          }
        }
      });
    })
    .catch(error => {
      console.error('Error fetching data:', error);
    });
  //doughnutChart
  fetch('http://localhost:3000/borrowEquipment')
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      console.log("Fetched Data:", data); // üõ† Debug: ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• API

      const doughnutCtx1 = document.getElementById('doughnutChart1');


      if (!doughnutCtx1) {
        console.error("Canvas element donut not found!");
        return;
      }

      new Chart(doughnutCtx1.getContext('2d'), {  // ‚úÖ ‡πÉ‡∏ä‡πâ .getContext('2d') ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
        type: 'doughnut',
        data: {
          labels: data.map(item => item.name), // ‚úÖ ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏µ‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
          datasets: [{
            data: data.map(item => item.total),
            backgroundColor: ['#E5D2BA', '#E54715', '#622BBE'], // ‚úÖ ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏µ
          }]
        },
        options: {
          responsive: true,
          cutout: '50%',
          plugins: {
            legend: { position: 'bottom' },
            title: { display: true, text: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏°' }
          }
        }
      });
    })
    .catch(error => {
      console.error("‚ùå Error fetching data:", error);
    });
  //doughtnut2
  fetch('http://localhost:3000/brokendEquipment')
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      console.log("Fetched Data:", data); // üõ† Debug: ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• API

      const doughnutCtx1 = document.getElementById('doughnutChart2');


      if (!doughnutCtx1) {
        console.error("Canvas element donut not found!");
        return;
      }

      new Chart(doughnutCtx1.getContext('2d'), {  // ‚úÖ ‡πÉ‡∏ä‡πâ .getContext('2d') ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
        type: 'doughnut',
        data: {
          labels: data.map(item => item.name), // ‚úÖ ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏µ‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
          datasets: [{
            data: data.map(item => item.total),
            backgroundColor: ['#E5D2BA', '#E54715', '#622BBE'], // ‚úÖ ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏µ
          }]
        },
        options: {
          responsive: true,

          plugins: {
            legend: { position: 'bottom' },
            title: { display: true, text: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°' }
          }

        }
      });
    })
    .catch(error => {
      console.error("‚ùå Error fetching data:", error);
    });
  function showDoughnutChart(chartNumber) {
    document.getElementById('doughnutChart1').style.display = (chartNumber === 1) ? 'block' : 'none';
    document.getElementById('doughnutChart2').style.display = (chartNumber === 2) ? 'block' : 'none';
  }
  //point line chart
 let chartInstance = null; // ‡πÄ‡∏Å‡πá‡∏ö instance ‡∏Ç‡∏≠‡∏á Chart ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà

function showChart(timeframe) {
  // ‚úÖ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å URL ‡∏ï‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
  const apiUrls = {
    day: "http://localhost:3000/daysroomday",
    week: "http://localhost:3000/daysroomweek",
    month: "http://localhost:3000/daysroommount",
    year: "http://localhost:3000/daysroomyear"
  };

  const apiUrl = apiUrls[timeframe];

  fetch(apiUrl)
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      console.log("Fetched Data:", data); // Debug ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• API

      const labels = data.map(item => item.time); // ‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ô
      const usageData = data.map(item => item.total_requests); // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á

      updateChart(labels, usageData, timeframe);
    })
    .catch(error => {
      console.error("‚ùå Error fetching data:", error);
    });
}

function updateChart(labels, values, timeframe) {
  const ctx = document.getElementById("pointLineChart").getContext("2d");

  // ‚úÖ ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ Chart ‡πÄ‡∏î‡∏¥‡∏°‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏´‡πâ‡∏•‡∏ö‡∏Å‡πà‡∏≠‡∏ô
  if (chartInstance) {
    chartInstance.destroy();
  }

  // ‚úÖ ‡∏ä‡∏∑‡πà‡∏≠ Title ‡∏ï‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤
  const titles = {
    day: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏±‡∏ô",
    week: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå",
    month: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
    year: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏µ"
  };

  // ‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á Line Chart ‡πÉ‡∏´‡∏°‡πà
  chartInstance = new Chart(ctx, {
    type: "line",
    data: {
      labels: labels,
      datasets: [{
        label: titles[timeframe],
        data: values,
        borderColor: "#007BFF",  // üîµ ‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô
        backgroundColor: "rgba(0, 123, 255, 0.2)",
        fill: false,  // üî• ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏µ‡πÉ‡∏ï‡πâ‡πÄ‡∏™‡πâ‡∏ô
        pointStyle: "circle",
        pointRadius: 5, // ‡∏à‡∏∏‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô
        pointBackgroundColor: "#007BFF",
      }]
    },
    options: {
      responsive: false,
      layout: {
        padding: {
          bottom: 0 // ‚úÖ ‡∏•‡∏ö‡∏£‡∏∞‡∏¢‡∏∞‡∏Ç‡∏≠‡∏ö‡∏•‡πà‡∏≤‡∏á
        }
      },
      plugins: {
        title: {
          display: true,
          text: titles[timeframe]
        },
        legend: {
          position: "bottom"
        }
      },
      scales: {
        x: {
          title: {
            display: true,
            text: "‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤"
          }
        },
        y: {
          beginAtZero: true,
          suggestedMin: 0,
          title: {
            display: true,
            text: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á"
          }
        }
      }
    }
  });
}

// ‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô "‡∏ß‡∏±‡∏ô"
showChart("day");

  //mostuser

  fetch("http://localhost:3000/useralldata")
    .then(response => response.json()) // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô JSON
    .then(data => {
      const userList = document.getElementById("userList");
      userList.innerHTML = "";  // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏î‡∏¥‡∏°

      data.forEach(user => {
        const div = document.createElement("div");
        div.className = "split-container";
        div.innerHTML = `<p>${user.name}</p> <p>${user.stat} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>`;
        userList.appendChild(div);
      });
    })
    .catch(error => {
      console.error("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:", error);
      document.getElementById("userList").innerHTML = "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ";
    });

  fetch("http://localhost:3000/mostreport")
    .then(response => response.json()) // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô JSON
    .then(data => {
      const userList = document.getElementById("ReportList");
      userList.innerHTML = "";  // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏î‡∏¥‡∏°

      data.forEach(user => {
        const div = document.createElement("div");
        div.className = "split-container";
        div.innerHTML = `<p>${user.name}</p> <p>${user.stat} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>`;
        userList.appendChild(div);
      });
    })
    .catch(error => {
      console.error("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:", error);
      document.getElementById("userList").innerHTML = "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ";
    });

  //most booking room card
  fetch('http://localhost:3000/box1')
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      console.log("‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:", data);
      if (data.length > 0) {
        document.getElementById('room-name').textContent = `${data[0].name} (${data[0].percentage}%)`;
      } else {
        document.getElementById('room-name').textContent = "No data available";
      }
    })
    .catch(error => {
      console.error("‚ùå Error fetching data:", error);
      document.getElementById('room-name').textContent = "Error loading data";
    });

  //most brokend equipment card
  fetch('http://localhost:3000/box2')
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      console.log("‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:", data);
      if (data.length > 0) {
        document.getElementById('equipment-name').textContent = `${data[0].name} (${data[0].percentage})%`;
      } else {
        document.getElementById('equipment-name').textContent = "No data available";
      }
    })
    .catch(error => {
      console.error("‚ùå Error fetching data:", error);
      document.getElementById('equipment-name').textContent = "Error loading data";
    });
  //most time
  fetch('http://localhost:3000/box3')
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      console.log("‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:", data);
      if (data.length > 0) {
        document.getElementById('time').textContent = `${data[0].time}(${data[0].percentage})%`;
      } else {
        document.getElementById('time').textContent = "No data available";
      }
    })
    .catch(error => {
      console.error("‚ùå Error fetching data:", error);
      document.getElementById('time').textContent = "Error loading data";
    });
  //most department
  fetch('http://localhost:3000/box4')
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      console.log("‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:", data);
      if (data.length > 0) {
        document.getElementById('department-name').textContent = `${data[0].name}(${data[0].percentage}%)`;
      } else {
        document.getElementById('department-name').textContent = "No data available";
      }
    })
    .catch(error => {
      console.error("‚ùå Error fetching data:", error);
      document.getElementById('department-name').textContent = "Error loading data";
    });
    
    //card chart1
    fetch('http://localhost:3000/TableRoomBooked')
  .then(response => response.json())
  .then(data => {
    // ‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô Labels
    const labels = data.map(item => item.room_name);
    // ‡∏î‡∏∂‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏µ‡∏¢‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô Chart
    const values = data.map(item => item.total);

    var ctx = document.getElementById('pointLineCardChart1').getContext('2d');
    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: labels,
        datasets: [{
          data: values,
          backgroundColor: 'rgba(255, 255, 255, 0.8)', // ‡∏™‡∏µ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ó‡πà‡∏á
          borderWidth: 0,
          barPercentage: 1,
          categoryPercentage: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { display: false }, // ‡∏ã‡πà‡∏≠‡∏ô Legend
          tooltip: { enabled: false } // ‡∏ã‡πà‡∏≠‡∏ô Tooltip
        },
        scales: {
          x: { display: false }, // ‡∏ã‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡∏ô X
          y: { display: false } // ‡∏ã‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡∏ô Y
        }
      }
    });
  })
  .catch(error => console.error("‚ùå Error fetching data:", error));



    //card chart 2
fetch('http://localhost:3000/TableBrokenEqipment')
  .then(response => response.json())
  .then(data => {
    // ‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏µ‡∏¢‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô Labels
    const labels = data.map(item => item.name);
    // ‡∏î‡∏∂‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏µ‡∏¢‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô Chart
    const values = data.map(item => item.totalbrokend);

    var ctx = document.getElementById('pointLineCardChart2').getContext('2d');
    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: labels,
        datasets: [{
          data: values,
          backgroundColor: 'rgba(255, 255, 255, 0.8)', // ‡∏™‡∏µ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ó‡πà‡∏á
          borderWidth: 0,
          barPercentage: 1,
          categoryPercentage: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { display: false }, // ‡∏ã‡πà‡∏≠‡∏ô Legend
          tooltip: { enabled: false } // ‡∏ã‡πà‡∏≠‡∏ô Tooltip
        },
        scales: {
          x: { display: false }, // ‡∏ã‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡∏ô X
          y: { display: false } // ‡∏ã‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡∏ô Y
        }
      }
    });
  })
  .catch(error => console.error("‚ùå Error fetching data:", error));

  //card chart 3
  fetch('http://localhost:3000/daysroomday')
  .then(response => response.json())
  .then(data => {
    // ‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏µ‡∏¢‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô Labels
    const labels = data.map(item => item.time);
    // ‡∏î‡∏∂‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏µ‡∏¢‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô Chart
    const values = data.map(item => item.total_requests);

    var ctx = document.getElementById('pointLineCardChart3').getContext('2d');
    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: labels,
        datasets: [{
          data: values,
          backgroundColor: 'rgba(0, 0, 0, 0.5)', // ‡∏™‡∏µ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ó‡πà‡∏á
          borderWidth: 0,
          barPercentage: 1,
          categoryPercentage: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { display: false }, // ‡∏ã‡πà‡∏≠‡∏ô Legend
          tooltip: { enabled: false } // ‡∏ã‡πà‡∏≠‡∏ô Tooltip
        },
        scales: {
          x: { display: false }, // ‡∏ã‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡∏ô X
          y: { display: false } // ‡∏ã‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡∏ô Y
        }
      }
    });
  })
  .catch(error => console.error("‚ùå Error fetching data:", error));


//card chart4
  fetch('http://localhost:3000/box42')
  .then(response => response.json())
  .then(data => {
    // ‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏µ‡∏¢‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô Labels
    const labels = data.map(item => item.name);
    // ‡∏î‡∏∂‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏µ‡∏¢‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô Chart
    const values = data.map(item => item.d_count);

    var ctx = document.getElementById('pointLineCardChart4').getContext('2d');
    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: labels,
        datasets: [{
          data: values,
          backgroundColor: 'rgba(255, 255, 255, 0.8)', // ‡∏™‡∏µ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ó‡πà‡∏á
          borderWidth: 0,
          barPercentage: 1,
          categoryPercentage: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { display: false }, // ‡∏ã‡πà‡∏≠‡∏ô Legend
          tooltip: { enabled: false } // ‡∏ã‡πà‡∏≠‡∏ô Tooltip
        },
        scales: {
          x: { display: false }, // ‡∏ã‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡∏ô X
          y: { display: false } // ‡∏ã‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡∏ô Y
        }
      }
    });
  })
  .catch(error => console.error("‚ùå Error fetching data:", error));



</script>

</html>